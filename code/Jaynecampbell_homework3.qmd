---
title: "homework03JC"
author: "Jayne Campbell"
format: html
editor: visual
---
link: https://github.com/jayne-campbell/Campbell-Jayne_homework-03.git

Homework 3

Loading in packages and data
```{r} 
# general use
library(tidyverse)
library(readxl)
library(here)
library(janitor)

# visualizing pairs
library(GGally)

# model selection
library(MuMIn)

# model predictions
library(ggeffects)

# model tables
library(gtsummary)
library(flextable)
library(modelsummary)

drought_exp <- read_xlsx(path = here("data", # reading in data
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")

# quick look at data 
str(drought_exp)
class(drought_exp)

```

cleaning the data
```{r}
# cleaning
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water
```


Problem 1. Multiple linear regression: model selection and construction

a. Make a table or list of all the models from class and the last one you constructed on your own. Write a caption for your table.

```{r}
models <- data.frame(
  Model_numbers = c("Model 0", "Model 1", "Model 2", "Model 3", "Model 4"),
  Model = c("null model", "saturated model", "two predictors", "two predictors", "two predictors"),
  Predictors = c("none", "SLA, water treatment, and species", "SLA and water treatment", "SLA and species", "water treatment and species")
)

modeldatatable <- flextable(models) %>% # create flextable
set_header_labels(Model_numbers = "Model numbers", Model = "Model", Predictors = "Predictors") %>% # rename headers 
  align(align = "center", part = "all") %>% # formatting 
  autofit() %>%
  theme_vanilla() %>%
  bold(part = "header") #bold everything in the header
```


Table 1. Five models that predict the total biomass of plant species. Each row represents one of the models. The columns represent the model number, the model, and the predictors for that model. SLA stands for the specific leaf area, which is the surface area of a leaf divided by its dry mass and it represents life strategy (mm^2^/g).

```{r}
print(modeldatatable)
```
  
b. Write a 5-6 sentence "statistical methods" section

In this scenario, we're interested in how three variables affect total biomass: species (categorical), water treatment (categorical), specific leaf area (SLA, numeric). In order to examine the influence of species, water treatment, and specific leaf area on plant biomass, I created five models based on the three potential predictors. These included a null model, a saturated model, and three models with two predictors each. To determine which linear model best predicted the biomass, I used Akaike Information Criterion (AIC), which takes into account how well the model predicts the data as well as increasing complexity. Out of the five models we have tried, the best model was the one that included water treatment and species because it produced the lowest AIC (AIcc = -158.8). I visually determined that my final model conformed to the assumptions of a linear model by looking at the diagnostics and ensuring there was random and even dispersion, homoscedasticity, normality of variance and no excessive outliers. 

c. Make a visualization of the model predictions with underlying data for you "best" model

```{r}
# model of total biomass as a function of water treatment and species
model4 <- lm(total_g ~ species_name + water_treatment, # formula for model
             data = drought_exp_clean) # data frame

plot(model4) # printing plots for model 4
```
```{r}
summary(model4) # summary of this model
```
```{r}
model_preds <- ggpredict(model4, # create model predictions 
                         terms = c("water_treatment", 
                                   "species_name"))

View(model_preds) # View the predictions as a data frame
```

Creating visualization for best model (predictors = water treatment and species)

```{r}
# creating new data frame of model predictions for plotting
model_preds_for_plotting <- model_preds %>% 
  rename( # renaming columns to make this easier to use
         water_treatment = x,
         species_name = group)

ggplot() +
  # underlying data
  geom_point(data = drought_exp_clean,
             aes(x = water_treatment,
                 y = total_g,)) +
  # model prediction 95% CI ribbon
  geom_ribbon(data = model_preds_for_plotting,
              aes(x = species_name, 
                  y = predicted,
                  ymin = conf.low,
                  ymax = conf.high,
                  fill = water_treatment),
              alpha = 0.2) +
  # model prediction lines
   geom_line(data = model_preds_for_plotting,
            aes(x = species_name, 
                y = predicted,
                color = water_treatment)) +
  # cleaner theme
  theme_classic() +
  # creating different panels for species
  facet_wrap(~species_name)
```

d. write a caption for your visualization
  include a data citation
  
e. Results section

The predictors, water treatment and species, best described the total mass based on model statistics...
On average, the biomass was lower for drought stressed plants than for well watered plants, which aligns with biological knowledge. 
On average, plant species with larger ranges tended to have larger biomasses. 

Problem 2. Affective visualization

a. Describe in words what an affective visualization could look like for your personal data

Since affective visualizations prioritize creativity and should convey emotion, I would like to draw images of the types of caffeinated beverages I have been drinking. I could do different shapes and colors for each beverage and make the sizes dependent on the amount of caffeine in each. I could also organize them by time of day by having a symbol for morning, afternoon, and night and clump the other symbols around them. I would create a key for each of the symbols and describe what they represent.

b. Create a sketch on paper of your idea



c. Make a draft of your visualization
Painting


d. Write an artist statement 

This visualization shows my consumption of caffeinated beverages in terms of the type, approximate caffiene content, and the time of day they were consumed at. I was very influenced by the Dear Data project done by Giorgia Lupi and Stefanie Posavec and their use of symbols and keys to convey information and messages. My work is in the form of acrylic paint and ink pen on a 8 by 12 inch canvas. I created my work by first creating an outline of where I wanted everything and using a ruler and pencil to map it out. Then I began to use acrylic paint and a pen to fill in and draw the symbols and write the key. 

Problem 3. statistical critique

a. Revisit and summarize

b. Visual clarity

c. Aesthetic clarity

d. Recommendations





