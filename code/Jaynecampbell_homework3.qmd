---
title: "homework03JC"
author: "Jayne Campbell"
format: html
editor: visual
---
link: https://github.com/jayne-campbell/Campbell-Jayne_homework-03.git

Homework 3

Loading in packages and data
```{r} 
# general use
library(tidyverse)
library(readxl)
library(here)
library(janitor)

# visualizing pairs
library(GGally)

# model selection
library(MuMIn)

# model predictions
library(ggeffects)

# model tables
library(gtsummary)
library(flextable)
library(modelsummary)

drought_exp <- read_xlsx(path = here("data", # reading in data
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")

# quick look at data 
str(drought_exp)
class(drought_exp)

```

cleaning the data
```{r}
# cleaning
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water
```


Problem 1. Multiple linear regression: model selection and construction

a. Make a table or list of all the models from class and the last one you constructed on your own. Write a caption for your table.

Table 1. Five models that predict the total biomass of plant species. Each row represents one of the models. The columns represent the model number, the model, and the predictors for that model. 

1. null model: Total mass is not predicted by any of the three predictors.
  no predictors

2. saturated model: Total mass predicted by SLA, water treatment, and species. (all three)
  predictors = SLA, water treatment, and species
  
3. Total biomass as a function of SLA and water treatment 
  predictors = SLA and water treatment
  
4. Total biomass as a function of SLA and species
  predictors = SLA and species
  
5. Total biomass as a function of water treatment and species
  predictors = water treatment and species 
  
b. Write a 5-6 sentence "statistical methods" section

In order to examine the influence of , , and  on biomass, I 

Out of the five models we have tried, the best model is the one that includes the water treatment and species. 

c. Make a visualization of the model predictions with underlying data for you "best" model

```{r}
# model of total biomass as a function of water treatment and species
model5 <- lm(total_g ~ species_name + water_treatment, # formula for model
             data = drought_exp_clean) # data frame

plot(model5) # printing plots for model 5
```
```{r}
summary(model5) # summary of this model
```
```{r}
model_preds <- ggpredict(model4, # create model predictions 
                         terms = c("water_treatment", 
                                   "species_name"))

View(model_preds) # View the predictions as a data frame
```

Creating visualization for best model (predictors = water treatment and species)

```{r}
# creating new data frame of model predictions for plotting
model_preds_for_plotting <- model_preds %>% 
  rename( # renaming columns to make this easier to use
         water_treatment = x,
         species_name = group)

# use View(model_preds_for_plotting) 
# to compare this to the original model_preds data frame

ggplot() +
  # underlying data
  geom_point(data = drought_exp_clean,
             aes(x = species_name,
                 y = total_g,
                 color = water_treatment)) +
  # model prediction 95% CI ribbon
  geom_ribbon(data = model_preds_for_plotting,
              aes(x = species_name, 
                  y = predicted,
                  ymin = conf.low,
                  ymax = conf.high,
                  fill = water_treatment),
              alpha = 0.2) +
  # model prediction lines
  geom_line(data = model_preds_for_plotting,
            aes(x = species_name, 
                y = predicted,
                color = water_treatment)) +
  # cleaner theme
  theme_classic() +
  # creating different panels for species
  facet_wrap(~species_name) 
```


Problem 2. Affective visualization

a. Describe is words what an affective visualization could look like for your personal data

b. Create a sketch on paper of your idea

- insert a photo of it 

c. Make a draft of your visualization

d. Write an artist statement 



Problem 3. statistical critique

a. Revisit and summarize

b. Visual clarity

c. Aesthetic clarity

d. Recommendations





